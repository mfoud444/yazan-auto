import{d as Y,S as w,J as Ue,E as H,K as We,L as fe,a$ as rt,b0 as ut,ap as dt,m as N,aq as ct,ar as mt,aQ as Q,n as pt,O as ft,k as F,b1 as vt,z as B,a0 as Me,b2 as Be,V as ze,W as Fe,b3 as $e,aP as gt,aG as ee,a_ as ht,b4 as bt,H as Ke,b5 as yt,b6 as xt,Q as wt,R as Ct,b7 as kt,aR as It,b8 as Dt,aA as St,i as ve,b9 as Ae,aI as Pe,j as Ve,t,p as ge,o as G,c as ie,b as A,e as z,u as e,a as n,w as d,af as ae,A as V,B as W,l as X,C as he,al as Te,a7 as Re,ab as Nt,ai as Ut,aj as pe,ak as Rt,a2 as Oe,_ as Ee,am as At,an as je}from"./index-2283ff34.js";import{N as Ge}from"./Grid-2cd1e46d.js";import{N as k}from"./FormItemGridItem-0cc98245.js";import{N as re,a as Pt}from"./Switch-e5673479.js";import{N as Je}from"./Form-ba92273a.js";import{N as Vt}from"./Avatar-82ce1bd1.js";import{N as Tt}from"./Badge-e416dc16.js";import{N as te}from"./text-de123031.js";import"./FormItem-38c3009b.js";const _t=Y({name:"Remove",render(){return w("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},w("line",{x1:"400",y1:"256",x2:"112",y2:"256",style:`
        fill: none;
        stroke: currentColor;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-width: 32px;
      `}))}});function Mt(a){return a==null||typeof a=="string"&&a.trim()===""?null:Number(a)}function Bt(a){return a.includes(".")&&(/^(-)?\d+.*(\.|0)$/.test(a)||/^\.\d+$/.test(a))}function Se(a){return a==null?!0:!Number.isNaN(a)}function Le(a,h){return a==null?"":h===void 0?String(a):a.toFixed(h)}function Ne(a){if(a===null)return null;if(typeof a=="number")return a;{const h=Number(a);return Number.isNaN(h)?null:h}}const zt=Ue([H("input-number-suffix",`
 display: inline-block;
 margin-right: 10px;
 `),H("input-number-prefix",`
 display: inline-block;
 margin-left: 10px;
 `)]),qe=800,He=100,Ft=Object.assign(Object.assign({},fe.props),{autofocus:Boolean,loading:{type:Boolean,default:void 0},placeholder:String,defaultValue:{type:Number,default:null},value:Number,step:{type:[Number,String],default:1},min:[Number,String],max:[Number,String],size:String,disabled:{type:Boolean,default:void 0},validator:Function,bordered:{type:Boolean,default:void 0},showButton:{type:Boolean,default:!0},buttonPlacement:{type:String,default:"right"},readonly:Boolean,clearable:Boolean,keyboard:{type:Object,default:{}},updateValueOnInput:{type:Boolean,default:!0},parse:Function,format:Function,precision:Number,status:String,"onUpdate:value":[Function,Array],onUpdateValue:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onClear:[Function,Array],onChange:[Function,Array]}),O=Y({name:"InputNumber",props:Ft,setup(a){const{mergedBorderedRef:h,mergedClsPrefixRef:p,mergedRtlRef:f}=We(a),b=fe("InputNumber","-input-number",zt,rt,a,p),{localeRef:C}=ut("InputNumber"),y=dt(a),{mergedSizeRef:S,mergedDisabledRef:o,mergedStatusRef:U}=y,s=N(null),_=N(null),$=N(null),T=N(a.defaultValue),E=ct(a,"value"),g=mt(E,T),D=N(""),r=l=>{const m=String(l).split(".")[1];return m?m.length:0},i=l=>{const m=[a.min,a.max,a.step,l].map(x=>x===void 0?0:r(x));return Math.max(...m)},u=Q(()=>{const{placeholder:l}=a;return l!==void 0?l:C.value.placeholder}),c=Q(()=>{const l=Ne(a.step);return l!==null?l===0?1:Math.abs(l):1}),ue=Q(()=>{const l=Ne(a.min);return l!==null?l:null}),de=Q(()=>{const l=Ne(a.max);return l!==null?l:null}),J=l=>{const{value:m}=g;if(l===m){L();return}const{"onUpdate:value":x,onUpdateValue:R,onChange:K}=a,{nTriggerFormInput:j,nTriggerFormChange:Z}=y;K&&ee(K,l),R&&ee(R,l),x&&ee(x,l),T.value=l,j(),Z()},M=({offset:l,doUpdateIfValid:m,fixPrecision:x,isInputing:R})=>{const{value:K}=D;if(R&&Bt(K))return!1;const j=(a.parse||Mt)(K);if(j===null)return m&&J(null),null;if(Se(j)){const Z=r(j),{precision:se}=a;if(se!==void 0&&se<Z&&!x)return!1;let q=parseFloat((j+l).toFixed(se??i(j)));if(Se(q)){const{value:Ie}=de,{value:De}=ue;if(Ie!==null&&q>Ie){if(!m||R)return!1;q=Ie}if(De!==null&&q<De){if(!m||R)return!1;q=De}return a.validator&&!a.validator(q)?!1:(m&&J(q),q)}}return!1},L=()=>{const{value:l}=g;if(Se(l)){const{format:m,precision:x}=a;m?D.value=m(l):l===null||x===void 0||r(l)>x?D.value=Le(l,void 0):D.value=Le(l,x)}else D.value=String(l)};L();const v=Q(()=>M({offset:0,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})===!1),I=Q(()=>{const{value:l}=g;if(a.validator&&l===null)return!1;const{value:m}=c;return M({offset:-m,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1}),P=Q(()=>{const{value:l}=g;if(a.validator&&l===null)return!1;const{value:m}=c;return M({offset:+m,doUpdateIfValid:!1,isInputing:!1,fixPrecision:!1})!==!1});function le(l){const{onFocus:m}=a,{nTriggerFormFocus:x}=y;m&&ee(m,l),x()}function be(l){var m,x;if(l.target===((m=s.value)===null||m===void 0?void 0:m.wrapperElRef))return;const R=M({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0});if(R!==!1){const Z=(x=s.value)===null||x===void 0?void 0:x.inputElRef;Z&&(Z.value=String(R||"")),g.value===R&&L()}else L();const{onBlur:K}=a,{nTriggerFormBlur:j}=y;K&&ee(K,l),j(),ht(()=>{L()})}function ye(l){const{onClear:m}=a;m&&ee(m,l)}function xe(){const{value:l}=P;if(!l){ke();return}const{value:m}=g;if(m===null)a.validator||J(_e());else{const{value:x}=c;M({offset:x,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}function we(){const{value:l}=I;if(!l){Ce();return}const{value:m}=g;if(m===null)a.validator||J(_e());else{const{value:x}=c;M({offset:-x,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})}}const Qe=le,Xe=be;function _e(){if(a.validator)return null;const{value:l}=ue,{value:m}=de;return l!==null?Math.max(0,l):m!==null?Math.min(0,m):0}function Ye(l){ye(l),J(null)}function Ze(l){var m,x,R;!((m=$.value)===null||m===void 0)&&m.$el.contains(l.target)&&l.preventDefault(),!((x=_.value)===null||x===void 0)&&x.$el.contains(l.target)&&l.preventDefault(),(R=s.value)===null||R===void 0||R.activate()}let ne=null,oe=null,ce=null;function Ce(){ce&&(window.clearTimeout(ce),ce=null),ne&&(window.clearInterval(ne),ne=null)}function ke(){me&&(window.clearTimeout(me),me=null),oe&&(window.clearInterval(oe),oe=null)}function et(){Ce(),ce=window.setTimeout(()=>{ne=window.setInterval(()=>{we()},He)},qe),Be("mouseup",document,Ce,{once:!0})}let me=null;function tt(){ke(),me=window.setTimeout(()=>{oe=window.setInterval(()=>{xe()},He)},qe),Be("mouseup",document,ke,{once:!0})}const at=()=>{oe||xe()},lt=()=>{ne||we()};function nt(l){var m,x;if(l.key==="Enter"){if(l.target===((m=s.value)===null||m===void 0?void 0:m.wrapperElRef))return;M({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&((x=s.value)===null||x===void 0||x.deactivate())}else if(l.key==="ArrowUp"){if(!P.value||a.keyboard.ArrowUp===!1)return;l.preventDefault(),M({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&xe()}else if(l.key==="ArrowDown"){if(!I.value||a.keyboard.ArrowDown===!1)return;l.preventDefault(),M({offset:0,doUpdateIfValid:!0,isInputing:!1,fixPrecision:!0})!==!1&&we()}}function ot(l){D.value=l,a.updateValueOnInput&&!a.format&&!a.parse&&a.precision===void 0&&M({offset:0,doUpdateIfValid:!0,isInputing:!0,fixPrecision:!1})}pt(g,()=>{L()});const st={focus:()=>{var l;return(l=s.value)===null||l===void 0?void 0:l.focus()},blur:()=>{var l;return(l=s.value)===null||l===void 0?void 0:l.blur()},select:()=>{var l;return(l=s.value)===null||l===void 0?void 0:l.select()}},it=ft("InputNumber",f,p);return Object.assign(Object.assign({},st),{rtlEnabled:it,inputInstRef:s,minusButtonInstRef:_,addButtonInstRef:$,mergedClsPrefix:p,mergedBordered:h,uncontrolledValue:T,mergedValue:g,mergedPlaceholder:u,displayedValueInvalid:v,mergedSize:S,mergedDisabled:o,displayedValue:D,addable:P,minusable:I,mergedStatus:U,handleFocus:Qe,handleBlur:Xe,handleClear:Ye,handleMouseDown:Ze,handleAddClick:at,handleMinusClick:lt,handleAddMousedown:tt,handleMinusMousedown:et,handleKeyDown:nt,handleUpdateDisplayedValue:ot,mergedTheme:b,inputThemeOverrides:{paddingSmall:"0 8px 0 10px",paddingMedium:"0 8px 0 12px",paddingLarge:"0 8px 0 14px"},buttonThemeOverrides:F(()=>{const{self:{iconColorDisabled:l}}=b.value,[m,x,R,K]=vt(l);return{textColorTextDisabled:`rgb(${m}, ${x}, ${R})`,opacityDisabled:`${K}`}})})},render(){const{mergedClsPrefix:a,$slots:h}=this,p=()=>w($e,{text:!0,disabled:!this.minusable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleMinusClick,onMousedown:this.handleMinusMousedown,ref:"minusButtonInstRef"},{icon:()=>ze(h["minus-icon"],()=>[w(Fe,{clsPrefix:a},{default:()=>w(_t,null)})])}),f=()=>w($e,{text:!0,disabled:!this.addable||this.mergedDisabled||this.readonly,focusable:!1,theme:this.mergedTheme.peers.Button,themeOverrides:this.mergedTheme.peerOverrides.Button,builtinThemeOverrides:this.buttonThemeOverrides,onClick:this.handleAddClick,onMousedown:this.handleAddMousedown,ref:"addButtonInstRef"},{icon:()=>ze(h["add-icon"],()=>[w(Fe,{clsPrefix:a},{default:()=>w(gt,null)})])});return w("div",{class:[`${a}-input-number`,this.rtlEnabled&&`${a}-input-number--rtl`]},w(B,{ref:"inputInstRef",autofocus:this.autofocus,status:this.mergedStatus,bordered:this.mergedBordered,loading:this.loading,value:this.displayedValue,onUpdateValue:this.handleUpdateDisplayedValue,theme:this.mergedTheme.peers.Input,themeOverrides:this.mergedTheme.peerOverrides.Input,builtinThemeOverrides:this.inputThemeOverrides,size:this.mergedSize,placeholder:this.mergedPlaceholder,disabled:this.mergedDisabled,readonly:this.readonly,textDecoration:this.displayedValueInvalid?"line-through":void 0,onFocus:this.handleFocus,onBlur:this.handleBlur,onKeydown:this.handleKeyDown,onMousedown:this.handleMouseDown,onClear:this.handleClear,clearable:this.clearable,internalLoadingBeforeSuffix:!0},{prefix:()=>{var b;return this.showButton&&this.buttonPlacement==="both"?[p(),Me(h.prefix,C=>C?w("span",{class:`${a}-input-number-prefix`},C):null)]:(b=h.prefix)===null||b===void 0?void 0:b.call(h)},suffix:()=>{var b;return this.showButton?[Me(h.suffix,C=>C?w("span",{class:`${a}-input-number-suffix`},C):null),this.buttonPlacement==="right"?p():null,f()]:(b=h.suffix)===null||b===void 0?void 0:b.call(h)}}))}}),$t=Ue([Ue("@keyframes spin-rotate",`
 from {
 transform: rotate(0);
 }
 to {
 transform: rotate(360deg);
 }
 `),H("spin-container",{position:"relative"},[H("spin-body",`
 position: absolute;
 top: 50%;
 left: 50%;
 transform: translateX(-50%) translateY(-50%);
 `,[bt()])]),H("spin-body",`
 display: inline-flex;
 align-items: center;
 justify-content: center;
 flex-direction: column;
 `),H("spin",`
 display: inline-flex;
 height: var(--n-size);
 width: var(--n-size);
 font-size: var(--n-size);
 color: var(--n-color);
 `,[Ke("rotate",`
 animation: spin-rotate 2s linear infinite;
 `)]),H("spin-description",`
 display: inline-block;
 font-size: var(--n-font-size);
 color: var(--n-text-color);
 transition: color .3s var(--n-bezier);
 margin-top: 8px;
 `),H("spin-content",`
 opacity: 1;
 transition: opacity .3s var(--n-bezier);
 pointer-events: all;
 `,[Ke("spinning",`
 user-select: none;
 -webkit-user-select: none;
 pointer-events: none;
 opacity: var(--n-opacity-spinning);
 `)])]),Kt={small:20,medium:18,large:16},Ot=Object.assign(Object.assign({},fe.props),{description:String,stroke:String,size:{type:[String,Number],default:"medium"},show:{type:Boolean,default:!0},strokeWidth:Number,rotate:{type:Boolean,default:!0},spinning:{type:Boolean,validator:()=>!0,default:void 0},delay:Number}),Et=Y({name:"Spin",props:Ot,setup(a){const{mergedClsPrefixRef:h,inlineThemeDisabled:p}=We(a),f=fe("Spin","-spin",$t,yt,a,h),b=F(()=>{const{size:o}=a,{common:{cubicBezierEaseInOut:U},self:s}=f.value,{opacitySpinning:_,color:$,textColor:T}=s,E=typeof o=="number"?xt(o):s[wt("size",o)];return{"--n-bezier":U,"--n-opacity-spinning":_,"--n-size":E,"--n-color":$,"--n-text-color":T}}),C=p?Ct("spin",F(()=>{const{size:o}=a;return typeof o=="number"?String(o):o[0]}),b,a):void 0,y=kt(a,["spinning","show"]),S=N(!1);return It(o=>{let U;if(y.value){const{delay:s}=a;if(s){U=window.setTimeout(()=>{S.value=!0},s),o(()=>{clearTimeout(U)});return}}S.value=y.value}),{mergedClsPrefix:h,active:S,mergedStrokeWidth:F(()=>{const{strokeWidth:o}=a;if(o!==void 0)return o;const{size:U}=a;return Kt[typeof U=="number"?"medium":U]}),cssVars:p?void 0:b,themeClass:C==null?void 0:C.themeClass,onRender:C==null?void 0:C.onRender}},render(){var a,h;const{$slots:p,mergedClsPrefix:f,description:b}=this,C=p.icon&&this.rotate,y=(b||p.description)&&w("div",{class:`${f}-spin-description`},b||((a=p.description)===null||a===void 0?void 0:a.call(p))),S=p.icon?w("div",{class:[`${f}-spin-body`,this.themeClass]},w("div",{class:[`${f}-spin`,C&&`${f}-spin--rotate`],style:p.default?"":this.cssVars},p.icon()),y):w("div",{class:[`${f}-spin-body`,this.themeClass]},w(Dt,{clsPrefix:f,style:p.default?"":this.cssVars,stroke:this.stroke,"stroke-width":this.mergedStrokeWidth,class:`${f}-spin`}),y);return(h=this.onRender)===null||h===void 0||h.call(this),p.default?w("div",{class:[`${f}-spin-container`,this.themeClass],style:this.cssVars},w("div",{class:[`${f}-spin-content`,this.active&&`${f}-spin-content--spinning`]},p),w(St,{name:"fade-in-transition"},{default:()=>this.active?S:null})):S}}),jt={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},Lt={class:"post-heading mb-1"},qt={class:"gtext text-2xl font-bold underlined"},Ht={style:{display:"flex","justify-content":"flex-end"}},Wt=Y({__name:"Add",setup(a){const{isMobile:h}=ve(),p=F(()=>h?24:12),f=Ae(),b=Pe(),C=Ve(),y=N(null),S=N(!1),o=N(f.initState()),U={name:[{required:!0,message:t("common.nameRequired"),trigger:["input","blur"]}],modelCode:[{required:!0,message:t("common.modelCodeRequired"),trigger:["input","blur"]}],companyId:[{required:!0,message:t("common.companyIdRequired"),trigger:["input","blur"]}]},s=[{label:t("common.text"),value:"Text"},{label:t("common.image"),value:"Image"},{label:t("common.audio"),value:"Audio"},{label:t("common.video"),value:"Video"},{label:t("common.documents"),value:"Documents"}],_=N([]);async function $(){try{await b.fetchDataAction({limit:1e3,offset:0}),b.listCompanies=await Promise.all(b.listCompanies.map(async D=>{if(D.logoUrl)try{D.logoUrl=await Te(b.bucket,D.logoUrl)}catch(r){console.error(`Failed to fetch image for company ${D.name}:`,r)}return{...D}})),_.value=b.listCompanies.map(D=>({label:D.name,value:D.id,logoUrl:D.logoUrl}))}catch(D){console.error(t("chat.dataFetchError"),D.message)}}ge($);async function T(){try{S.value=!0,await f.insertDataAction(o.value),S.value=!1,f.showModelAdd=!1,C.success(t("common.addSuccess"))}catch(D){S.value=!1,console.error(t("common.addFailed"),D.message),C.error(t("common.addFailed"))}}function E(){return!o.value.name||!o.value.modelCode||!o.value.companyId||S.value}function g(D){var r;D.preventDefault(),(r=y.value)==null||r.validate(i=>{i?C.error(t("auth.fillAllField")):T()})}return(D,r)=>(G(),ie("div",jt,[A("div",Lt,[A("div",qt,z(e(t)("common.addNew")),1)]),n(e(Je),{ref_key:"formRef",ref:y,model:o.value,rules:U,size:"large"},{default:d(()=>[A("div",null,[n(e(Ge),{span:p.value,"x-gap":24},{default:d(()=>[n(e(k),{span:p.value,path:"companyId",label:e(t)("common.company")},{default:d(()=>[n(e(ae),{value:o.value.companyId,"onUpdate:value":r[0]||(r[0]=i=>o.value.companyId=i),options:_.value,placeholder:e(t)("common.selectCompany"),clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"name",label:e(t)("common.name")},{default:d(()=>[n(e(B),{value:o.value.name,"onUpdate:value":r[1]||(r[1]=i=>o.value.name=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.name"),clearable:"",onKeydown:r[2]||(r[2]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"modelCode",label:e(t)("common.modelCode")},{default:d(()=>[n(e(B),{value:o.value.modelCode,"onUpdate:value":r[3]||(r[3]=i=>o.value.modelCode=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.modelCode"),clearable:"",onKeydown:r[4]||(r[4]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"description",label:e(t)("common.description")},{default:d(()=>[n(e(B),{value:o.value.description,"onUpdate:value":r[5]||(r[5]=i=>o.value.description=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.description"),clearable:"",onKeydown:r[6]||(r[6]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"version",label:e(t)("common.version")},{default:d(()=>[n(e(B),{value:o.value.version,"onUpdate:value":r[7]||(r[7]=i=>o.value.version=i),onKeyup:V(g,["enter"]),placeholder:e(t)("common.version"),clearable:"",onKeydown:r[8]||(r[8]=V(W(()=>{},["prevent"]),["enter"]))},null,8,["value","onKeyup","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"inputData",label:e(t)("common.inputData")},{default:d(()=>[n(e(ae),{value:o.value.inputData,"onUpdate:value":r[9]||(r[9]=i=>o.value.inputData=i),options:s,multiple:"",placeholder:e(t)("common.selectInputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"outputData",label:e(t)("common.outputData")},{default:d(()=>[n(e(ae),{value:o.value.outputData,"onUpdate:value":r[10]||(r[10]=i=>o.value.outputData=i),options:s,multiple:"",placeholder:e(t)("common.selectOutputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:12,path:"maxTokens",label:e(t)("common.maxTokens")},{default:d(()=>[n(e(O),{value:o.value.maxTokens,"onUpdate:value":r[11]||(r[11]=i=>o.value.maxTokens=i),placeholder:e(t)("common.maxTokens"),min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"temperature",label:e(t)("common.temperature")},{default:d(()=>[n(e(O),{value:o.value.temperature,"onUpdate:value":r[12]||(r[12]=i=>o.value.temperature=i),placeholder:e(t)("common.temperature"),step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topP",label:e(t)("common.topP")},{default:d(()=>[n(e(O),{value:o.value.topP,"onUpdate:value":r[13]||(r[13]=i=>o.value.topP=i),placeholder:e(t)("common.topP"),step:"0.01",min:"0",max:"1"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topK",label:e(t)("common.topK")},{default:d(()=>[n(e(O),{value:o.value.topK,"onUpdate:value":r[14]||(r[14]=i=>o.value.topK=i),placeholder:e(t)("common.topK"),min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"repetitionPenalty",label:e(t)("common.repetitionPenalty")},{default:d(()=>[n(e(O),{value:o.value.repetitionPenalty,"onUpdate:value":r[15]||(r[15]=i=>o.value.repetitionPenalty=i),placeholder:e(t)("common.repetitionPenalty"),step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:p.value,path:"stop",label:e(t)("common.stop")},{default:d(()=>[n(e(B),{value:o.value.stop,"onUpdate:value":r[16]||(r[16]=i=>o.value.stop=i),placeholder:e(t)("common.stopPlaceholder"),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"stream",label:e(t)("common.stream")},{default:d(()=>[n(e(re),{value:o.value.stream,"onUpdate:value":r[17]||(r[17]=i=>o.value.stream=i),size:"large"},null,8,["value"])]),_:1},8,["span","label"]),n(e(k),{span:p.value,path:"isActivate",label:e(t)("common.isActivate")},{default:d(()=>[n(e(re),{value:o.value.isActivate,"onUpdate:value":r[18]||(r[18]=i=>o.value.isActivate=i),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1},8,["span"])]),A("div",Ht,[n(e(X),{type:"primary",style:{width:"100%"},size:"large",loading:S.value,disabled:E(),onClick:g},{default:d(()=>[he(z(e(t)("common.addNew")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),Gt={class:"border-none shadow-none flex flex-col gap-2 p-2 rounded-lg"},Jt={class:"post-heading mb-1"},Qt={class:"gtext text-2xl font-bold underlined"},Xt={style:{display:"flex","justify-content":"flex-end"}},Yt=Y({__name:"Update",props:{item:{}},setup(a){const h=a,{isMobile:p}=ve(),f=F(()=>p?24:12),b=Ae(),C=Pe(),y=Ve(),S=N(null),o=N(!1),U=N({...h.item}),s=N({...h.item}),_={name:[{required:!0,message:t("common.nameRequired"),trigger:["input","blur"]}],modelCode:[{required:!0,message:t("common.modelCodeRequired"),trigger:["input","blur"]}],companyId:[{required:!0,message:t("common.companyIdRequired"),trigger:["input","blur"]}]};async function $(){try{o.value=!0,await b.updateDataAction(s.value),o.value=!1,b.showModelUpdate=!1,y.success(t("common.updateSuccess"))}catch(i){o.value=!1,console.error(t("common.updateFailed"),i.message),y.error(t("common.updateFailed"),i.message)}}const T=[{label:t("common.text"),value:"Text"},{label:t("common.image"),value:"Image"},{label:t("common.audio"),value:"Audio"},{label:t("common.video"),value:"Video"},{label:t("common.documents"),value:"Documents"}],E=F(()=>o.value||!s.value.name||!s.value.modelCode||!s.value.companyId||JSON.stringify(s.value)===JSON.stringify(U.value));function g(i){var u;i.preventDefault(),(u=S.value)==null||u.validate(c=>{c?y.error(t("auth.fillAllField")):$()})}const D=N([]);async function r(){try{await C.fetchDataAction({limit:1e3,offset:0}),C.listCompanies=await Promise.all(C.listCompanies.map(async i=>{if(i.logoUrl)try{i.logoUrl=await Te(C.bucket,i.logoUrl)}catch(u){console.error(`Failed to fetch image for company ${i.name}:`,u)}return{...i}})),D.value=C.listCompanies.map(i=>({label:i.name,value:i.id,logoUrl:i.logoUrl}))}catch(i){console.error(t("chat.dataFetchError"),i.message)}finally{}}return ge(r),(i,u)=>(G(),ie("div",Gt,[A("div",Jt,[A("div",Qt,z(e(t)("common.update")),1)]),n(e(Je),{ref_key:"formRef",ref:S,model:s.value,rules:_,size:"large"},{default:d(()=>[A("div",null,[n(e(Ge),{span:f.value,"x-gap":24},{default:d(()=>[n(e(k),{span:f.value,path:"companyId",label:e(t)("common.company")},{default:d(()=>[n(e(ae),{value:s.value.companyId,"onUpdate:value":u[0]||(u[0]=c=>s.value.companyId=c),options:e(C).listCompanies.map(c=>({label:c.name,value:c.id})),placeholder:e(t)("common.selectCompany"),clearable:""},null,8,["value","options","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"name",label:e(t)("common.name")},{default:d(()=>[n(e(B),{value:s.value.name,"onUpdate:value":u[1]||(u[1]=c=>s.value.name=c),placeholder:e(t)("common.name"),clearable:"",onKeydown:u[2]||(u[2]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"modelCode",label:e(t)("common.modelCode")},{default:d(()=>[n(e(B),{value:s.value.modelCode,"onUpdate:value":u[3]||(u[3]=c=>s.value.modelCode=c),placeholder:e(t)("common.modelCode"),clearable:"",onKeydown:u[4]||(u[4]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"description",label:e(t)("common.description")},{default:d(()=>[n(e(B),{value:s.value.description,"onUpdate:value":u[5]||(u[5]=c=>s.value.description=c),placeholder:e(t)("common.description"),clearable:"",onKeydown:u[6]||(u[6]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"version",label:e(t)("common.version")},{default:d(()=>[n(e(B),{value:s.value.version,"onUpdate:value":u[7]||(u[7]=c=>s.value.version=c),placeholder:e(t)("common.version"),clearable:"",onKeydown:u[8]||(u[8]=V(W(()=>{},["prevent"]),["enter"])),onKeyup:V(g,["enter"])},null,8,["value","placeholder","onKeyup"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"inputData",label:e(t)("common.inputData")},{default:d(()=>[n(e(ae),{value:s.value.inputData,"onUpdate:value":u[9]||(u[9]=c=>s.value.inputData=c),options:T,multiple:"",placeholder:e(t)("common.selectInputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"outputData",label:e(t)("common.outputData")},{default:d(()=>[n(e(ae),{value:s.value.outputData,"onUpdate:value":u[10]||(u[10]=c=>s.value.outputData=c),options:T,multiple:"",placeholder:e(t)("common.selectOutputData"),clearable:""},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:12,path:"maxTokens",label:e(t)("common.maxTokens")},{default:d(()=>[n(e(O),{value:s.value.maxTokens,"onUpdate:value":u[11]||(u[11]=c=>s.value.maxTokens=c),placeholder:e(t)("common.maxTokens"),min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"temperature",label:e(t)("common.temperature")},{default:d(()=>[n(e(O),{value:s.value.temperature,"onUpdate:value":u[12]||(u[12]=c=>s.value.temperature=c),placeholder:e(t)("common.temperature"),step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topP",label:e(t)("common.topP")},{default:d(()=>[n(e(O),{value:s.value.topP,"onUpdate:value":u[13]||(u[13]=c=>s.value.topP=c),placeholder:e(t)("common.topP"),step:"0.01",min:"0",max:"1"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"topK",label:e(t)("common.topK")},{default:d(()=>[n(e(O),{value:s.value.topK,"onUpdate:value":u[14]||(u[14]=c=>s.value.topK=c),placeholder:e(t)("common.topK"),type:"number",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:12,path:"repetitionPenalty",label:e(t)("common.repetitionPenalty")},{default:d(()=>[n(e(O),{value:s.value.repetitionPenalty,"onUpdate:value":u[15]||(u[15]=c=>s.value.repetitionPenalty=c),placeholder:e(t)("common.repetitionPenalty"),type:"number",step:"0.01",min:"0"},null,8,["value","placeholder"])]),_:1},8,["label"]),n(e(k),{span:f.value,path:"stop",label:e(t)("common.stop")},{default:d(()=>[n(e(B),{value:s.value.stop,"onUpdate:value":u[16]||(u[16]=c=>s.value.stop=c),placeholder:e(t)("common.stopPlaceholder"),type:"textarea",autosize:{minRows:2,maxRows:4}},null,8,["value","placeholder"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"stream",label:e(t)("common.stream")},{default:d(()=>[n(e(re),{value:s.value.stream,"onUpdate:value":u[17]||(u[17]=c=>s.value.stream=c),size:"large"},null,8,["value"])]),_:1},8,["span","label"]),n(e(k),{span:f.value,path:"isActivate",label:e(t)("common.isActivate")},{default:d(()=>[n(e(re),{value:s.value.isActivate,"onUpdate:value":u[18]||(u[18]=c=>s.value.isActivate=c),size:"large"},null,8,["value"])]),_:1},8,["span","label"])]),_:1},8,["span"])]),A("div",Xt,[n(e(X),{type:"primary",style:{width:"100%"},size:"large",loading:o.value,disabled:E.value,onClick:g},{default:d(()=>[he(z(e(t)("common.update")),1)]),_:1},8,["loading","disabled"])])]),_:1},8,["model"])]))}}),Zt={key:1,class:"flex gap-4 item-center"},ea={class:"flex flex-col"},ta={class:"font-bold text-base"},aa={class:"w-36"},la={key:2},na=Y({__name:"Card",props:{companyId:{}},setup(a){const h=a,p=Pe(),f=N(null),b=N(!1);async function C(){b.value=!0;try{await p.fetchDataAction({limit:1e3,offset:0}),p.listCompanies=await Promise.all(p.listCompanies.map(async o=>{if(o.logoUrl)try{o.logoUrl=await Te(p.bucket,o.logoUrl)}catch(U){console.error(`Failed to fetch image for company ${o.name}:`,U)}return{...o}}))}catch(o){console.error(t("chat.dataFetchError"),o.message)}finally{b.value=!1}}async function y(){let o=p.listCompanies.find(U=>U.id===h.companyId);o||(await C(),o=p.listCompanies.find(U=>U.id===h.companyId)),o?f.value=o:console.error(`Company with ID ${h.companyId} not found`)}ge(y);const S=F(()=>{var o;return(o=f.value)!=null&&o.isActivate?"success":"error"});return ve(),(o,U)=>b.value?(G(),Re(e(Et),{key:0,size:"small"})):f.value?(G(),ie("div",Zt,[n(e(Tt),{dot:"",processing:!1,type:S.value},{default:d(()=>[n(e(Vt),{round:"",size:"medium",src:f.value.logoUrl},null,8,["src"])]),_:1},8,["type"]),A("div",ea,[A("div",ta,[n(e(Nt),{"line-clamp":1},{tooltip:d(()=>[A("div",aa,z(f.value.name),1)]),default:d(()=>[he(z(f.value.name)+" ",1)]),_:1})])])])):(G(),ie("div",la,[A("p",null,z(e(t)("common.companyNotFound")),1)]))}}),oa={class:"container_dashboard"},sa={class:"header_dashboard"},ia={class:"flex gap-2 justify-end items-center my-2 mt-8"},ra={class:"flex gap-2 items-center"},ua={class:"hidden md:block"},da={class:"flex gap-2 items-center"},ca={class:"hidden md:block"},wa=Y({__name:"List",setup(a){const{iconRender:h}=Rt(),p=N(!1),f=N(!1),b=N(!0),C=N(!1),y=Ae(),S=N([]),{isMobile:o}=ve(),U=Ut(),s=Ve(),_=N(null),$=F(()=>{const v=(g.page-1)*g.pageSize,I=v+g.pageSize;return y.listModels.slice(v,I)}),T=N(10),E=F(()=>y.countTotalData),g=pe({page:1,pageCount:F(()=>Math.ceil(E.value/T.value)),pageSize:T.value});async function D(v){y.showModelUpdate=!0,_.value=v}const r=pe({title:t("common.company"),key:"company",render(v){return w(na,{companyId:v.companyId})}}),i=pe([{title:t("common.name"),key:"name",align:"center",render(v){return w(te,{strong:!0},{default:()=>v.name})}},{title:t("common.modelCode"),key:"modelCode",align:"center",render(v){return w(te,{type:"info"},{default:()=>v.modelCode})},ellipsis:!0},{title:t("common.description"),key:"description",align:"center",render(v){return w(te,{},{default:()=>v.description||"N/A"})},ellipsis:!0},{title:t("common.version"),key:"version",align:"center",render(v){return w(te,{},{default:()=>v.version||"N/A"})},ellipsis:!0},{title:t("common.isActivate"),key:"isActivate",align:"center",render(v){return w(re,{value:v.isActivate,disabled:!0})}},{title:t("common.createdAt"),key:"createdAt",align:"center",render(v){return w(te,{},{default:()=>new Date(v.createdAt).toLocaleString()})}},{title:t("common.updatedAt"),key:"updatedAt",align:"center",render(v){return w(te,{},{default:()=>new Date(v.updatedAt).toLocaleString()})}}]),u=pe([{type:"selection"},r,...i,{title:t("common.actions"),key:"actions",align:"center",width:100,render(v){return w("div",{class:"flex gap-1"},[w(X,{strong:!0,tertiary:!0,size:"small",loading:f.value,style:"border-radius:100%",onClick:async()=>{try{await D(v)}catch(I){console.error(t("common.updateFailed"),I.message)}}},{default:()=>w(h({icon:"fluent:edit-32-regular",color:"blue"}))}),w(X,{strong:!0,tertiary:!0,size:"small",loading:p.value,style:"border-radius:100%",onClick:async()=>{try{de(v)}catch(I){console.error(t("common.deleteFailed"),I.message)}}},{default:()=>w(h({icon:"fluent:delete-32-regular",color:"red"}))})])}}]);async function c(){try{b.value=!0;const{page:v,pageSize:I}=g;await y.fetchDataAction({limit:I,offset:(v-1)*I})}catch(v){C.value=!0,console.error(t("chat.dataFetchError"),v.message)}finally{b.value=!1}}ge(async()=>{await c()});const ue=v=>v.id;function de(v){const I=U.warning({title:t("common.deleteConfirmation"),content:t("common.deleteConfirmationMessage"),positiveText:t("common.yes"),negativeText:t("common.no"),onPositiveClick:async()=>{try{I.loading=!0,await y.deleteDataAction(v.id),s.success(t("common.deleteSuccess"));const P=(g.page-1)*g.pageSize,le=P+g.pageSize;y.listModels.slice(P,le).length===0&&g.page>1&&(g.page-=1),await c()}catch{I.loading=!1,s.error(t("common.deleteFailed"))}finally{I.loading=!1}}})}function J(v){g.page=v,c()}function M(v){S.value=v}function L(){const v=U.warning({title:t("common.deleteConfirmation"),content:t("common.deleteConfirmationMessage"),positiveText:t("common.yes"),negativeText:t("common.no"),onPositiveClick:async()=>{try{v.loading=!0;const I=S.value.map(ye=>y.deleteDataAction(String(ye)));await Promise.all(I),s.success(t("common.deleteSuccess")),await c();const P=(g.page-1)*g.pageSize,le=P+g.pageSize;y.listModels.slice(P,le).length===0&&g.page>1&&(g.page-=1),await c()}catch(I){console.error(t("common.deleteFailed"),I.message),s.error(t("common.deleteFailed"))}finally{v.loading=!1}}})}return(v,I)=>(G(),ie("div",oa,[A("div",sa,z(e(t)("common.models")),1),A("div",null,[A("div",ia,[n(e(Oe),{vertical:""},{default:d(()=>[n(e(Oe),{justify:"space-between"},{default:d(()=>[n(e(X),{onClick:I[0]||(I[0]=P=>e(y).showModelAdd=!0),type:"primary"},{default:d(()=>[A("div",ra,[n(e(Ee),{icon:"mdi:add-bold",class:"text-base"}),A("div",ua,z(e(t)("common.add")),1)])]),_:1}),n(e(X),{strong:"",secondary:"",type:"error",disabled:!(S.value.length>0),onClick:L},{default:d(()=>[A("div",da,[n(e(Ee),{icon:"fluent:delete-32-regular",class:"text-base"}),A("div",ca,z(e(t)("common.delete")),1)])]),_:1},8,["disabled"])]),_:1}),C.value?(G(),Re(e(Pt),{key:1,status:"warning",title:"Error",description:"Error fetching data."},{footer:d(()=>[n(e(X),{onClick:c},{default:d(()=>[he(z(e(t)("common.tryAgain")),1)]),_:1})]),_:1})):(G(),Re(e(At),{key:0,remote:"","min-height":e(o)?380:540,"max-height":e(o)?400:700,size:(e(o),"small"),"checked-row-keys":S.value,"onUpdate:checkedRowKeys":[I[1]||(I[1]=P=>S.value=P),M],striped:"",loading:b.value,columns:u,data:$.value,"onUpdate:page":J,pagination:g,"row-key":ue},null,8,["min-height","max-height","size","checked-row-keys","loading","columns","data","pagination"])),n(e(je),{show:e(y).showModelAdd,"onUpdate:show":I[2]||(I[2]=P=>e(y).showModelAdd=P),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"800px"}},{default:d(()=>[n(Wt)]),_:1},8,["show"]),n(e(je),{show:e(y).showModelUpdate,"onUpdate:show":I[3]||(I[3]=P=>e(y).showModelUpdate=P),"mask-closable":!1,"auto-focus":!1,preset:"card",style:{width:"95%","max-width":"800px"}},{default:d(()=>[n(Yt,{item:_.value},null,8,["item"])]),_:1},8,["show"])]),_:1})])])]))}});export{wa as default};
